# PM-TXM

Данный репозиторий содержит пакет программ, разработанных Сипуниным К. В. и Щербининой А. А. под руководством Азаровой И. В. в рамках научно-технической практики на кафедре математической лингвистики филологического факультета СПбГУ в осеннем семестре 2017 г.

Цель практического задания — создание инструментария для морфологической аннотации текстов на русском языке с использованием [pymorphy2](https://pymorphy2.readthedocs.io/) и конвертации результатов в формат XML, пригодный для дальнейшей загрузки размеченных текстов в различные корпусные менеджеры — в частности, [TXM](http://textometrie.ens-lyon.fr/).

## process_gold.py

Для работы этого скрипта требуется установить модуль lxml — например, так:

`pip install lxml`.

Скрипт осуществляет регулярные замены в «золотом стандарте» (корпусе со снятой омонимией, использованном для извлечения эталонных списков триграмм):

1. замены на уровне документа в целом, написанные на регулярных выражениях и призванные решить проблему неаннотированных и нетипизированных элементов текста (в частности, знаков препинания);
2. замены на уровне отдельных тегсетов, направленные на их оптимизацию (отсечение значений лексико-грамматических разрядов в противовес грамматическим категориям, удаление избыточных граммем) и унификацию (с опорой на диссертационное исследование Новиковой А. Ю.).

Для работы скрипта требуется поместить файлы золотого стандарта в папку __gold__. Результирующие XML-документы помещаются в папку __otpt__.

## trigram_stat.py

Извлекает из XML-документов триграммы — упорядоченные тройки тегсетов из граммем — и выводит их в соответствующий файл (__trigrams.csv__) в виде списка, упорядоченного в соответствии с абсолютной частотой встречаемости.

Может работать в двух режимах: одиночном и групповом. Для запуска скрипта в одиночном режиме необходимо указать второй аргумент при вызове основной функции:

`get_trigrams(os.getcwd() + '\\otpt', 'FILE.xml')`,

где __FILE.xml__ — имя файла, из которого необходимо извлечь триграммы (например, одного из подкорпусов золотого стандарта). Если же аргумент не задан, то список триграмм будет построен с опорой на _все_ документы в формате XML, в момент запуска находящиеся в папке __otpt__.

## process_inpt.py

Скрипт требует предварительной установки nltk (оттуда импортируется функция токенизации) и pymorphy2:

`pip install nltk, pymorphy2`.

Производит морфологическую аннотацию входных текстов при помощи pymorphy2, внося в неё корректировки с учётом частотных характеристик локального контекста, содержащихся в извлечённом из эталонного корпуса перечне триграмм, и конвертирует размеченные тексты в формат XML.

Файлы в формате TXT следует поместить в папку __inpt__. При необходимости скорректировать их кодировку необходимо изменить последний аргумент в строке вызова основного класса:

`Processor(os.getcwd() + '\\inpt', os.getcwd() + '\\otpt', 'trigrams.csv', 'windows-1251').process()`.

В папку __otpt__ помещаются получающиеся на выходе XML-документы, а также лог-файлы, фиксирующие те словоформы, для которых триграмм в соответствующем списке не нашлось и которым пришлось приписать первую интерпретацию pymorphy2.
